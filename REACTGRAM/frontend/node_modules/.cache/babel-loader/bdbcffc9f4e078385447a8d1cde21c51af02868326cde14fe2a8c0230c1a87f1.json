{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/leoga/Desktop/Backup/GitHub/reactgram-project/REACTGRAM/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/leoga/Desktop/Backup/GitHub/reactgram-project/REACTGRAM/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/leoga/Desktop/Backup/GitHub/reactgram-project/REACTGRAM/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./EditProfile.css\";import{uploads}from\"../../utils/config\";// Hooks\nimport{useEffect,useState}from\"react\";import{useSelector,useDispatch}from\"react-redux\";// Redux\nimport{profile,updateProfile,resetMessage}from\"../../slices/userSlice\";// Components\nimport Message from\"../../components/Message\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.user;}),user=_useSelector.user,message=_useSelector.message,error=_useSelector.error,loading=_useSelector.loading;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),profileImage=_useState8[0],setProfileImage=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),bio=_useState10[0],setBio=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),previewImage=_useState12[0],setPreviewImage=_useState12[1];// Load user data\nuseEffect(function(){dispatch(profile());},[dispatch]);// fill user form\nuseEffect(function(){if(user){setName(user.name);setEmail(user.email);setBio(user.bio);}},[user]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var userData,formData,userFormData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();// Gather user data from states\nuserData={name:name};if(profileImage){userData.profileImage=profileImage;}if(bio){userData.bio=bio;}if(password){userData.password=password;}// build form data\nformData=new FormData();userFormData=Object.keys(userData).forEach(function(key){return formData.append(key,userData[key]);});formData.append(\"user\",userFormData);_context.next=10;return dispatch(updateProfile(formData));case 10:setTimeout(function(){dispatch(resetMessage());},2000);case 11:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var handleFile=function handleFile(e){// image preview\nvar image=e.target.files[0];setPreviewImage(image);// change image state\nsetProfileImage(image);};return/*#__PURE__*/_jsxs(\"div\",{id:\"edit-profile\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Edit your personal data\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitle\",children:\"Add a profile picture, and tell us a little more about yourself...\"}),(user.profileImage||previewImage)&&/*#__PURE__*/_jsx(\"img\",{className:\"profile-image\",src:previewImage?URL.createObjectURL(previewImage):\"\".concat(uploads,\"/users/\").concat(user.profileImage),alt:user.name}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Name\",onChange:function onChange(e){return setName(e.target.value);},value:name||\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"E-mail\",disabled:true,value:email||\"\"}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Profile Picture:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleFile})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Bio:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Profile description\",onChange:function onChange(e){return setBio(e.target.value);},value:bio||\"\"})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Want to change your password?\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Enter your new password...\",onChange:function onChange(e){return setPassword(e.target.value);},value:password||\"\"})]}),!loading&&/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Update\"}),loading&&/*#__PURE__*/_jsx(\"input\",{type:\"submit\",disabled:true,value:\"Loading...\"}),error&&/*#__PURE__*/_jsx(Message,{msg:error,type:\"error\"}),message&&/*#__PURE__*/_jsx(Message,{msg:message,type:\"success\"})]})]});};export default Profile;","map":{"version":3,"names":["uploads","useEffect","useState","useSelector","useDispatch","profile","updateProfile","resetMessage","Message","Profile","dispatch","state","user","message","error","loading","name","setName","email","setEmail","password","setPassword","profileImage","setProfileImage","bio","setBio","previewImage","setPreviewImage","handleSubmit","e","preventDefault","userData","formData","FormData","userFormData","Object","keys","forEach","key","append","setTimeout","handleFile","image","target","files","URL","createObjectURL","value"],"sources":["C:/Users/leoga/Desktop/Backup/GitHub/reactgram-project/REACTGRAM/frontend/src/pages/EditProfile/EditProfile.js"],"sourcesContent":["import \"./EditProfile.css\";\r\n\r\nimport { uploads } from \"../../utils/config\";\r\n\r\n// Hooks\r\nimport { useEffect, useState } from \"react\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\n\r\n// Redux\r\nimport { profile, updateProfile, resetMessage } from \"../../slices/userSlice\";\r\n\r\n// Components\r\nimport Message from \"../../components/Message\";\r\n\r\nconst Profile = () => {\r\n  const dispatch = useDispatch();\r\n\r\n  const { user, message, error, loading } = useSelector((state) => state.user);\r\n\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [profileImage, setProfileImage] = useState(\"\");\r\n  const [bio, setBio] = useState(\"\");\r\n  const [previewImage, setPreviewImage] = useState(\"\");\r\n\r\n  // Load user data\r\n  useEffect(() => {\r\n    dispatch(profile());\r\n  }, [dispatch]);\r\n\r\n  // fill user form\r\n  useEffect(() => {\r\n    if (user) {\r\n      setName(user.name);\r\n      setEmail(user.email);\r\n      setBio(user.bio);\r\n    }\r\n  }, [user]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Gather user data from states\r\n    const userData = {\r\n      name,\r\n    };\r\n\r\n    if (profileImage) {\r\n      userData.profileImage = profileImage;\r\n    }\r\n\r\n    if (bio) {\r\n      userData.bio = bio;\r\n    }\r\n\r\n    if (password) {\r\n      userData.password = password;\r\n    }\r\n\r\n    // build form data\r\n    const formData = new FormData();\r\n\r\n    const userFormData = Object.keys(userData).forEach((key) =>\r\n      formData.append(key, userData[key])\r\n    );\r\n\r\n    formData.append(\"user\", userFormData);\r\n\r\n    await dispatch(updateProfile(formData));\r\n\r\n    setTimeout(() => {\r\n      dispatch(resetMessage())\r\n    }, 2000)\r\n  }\r\n\r\n  const handleFile = (e) => {\r\n    // image preview\r\n    const image = e.target.files[0];\r\n\r\n    setPreviewImage(image);\r\n\r\n    // change image state\r\n    setProfileImage(image);\r\n  };\r\n\r\n  return (\r\n    <div id=\"edit-profile\">\r\n      <h2>Edit your personal data</h2>\r\n      <p className=\"subtitle\">\r\n      Add a profile picture, and tell us a little more about yourself...\r\n      </p>\r\n      {(user.profileImage || previewImage) && (\r\n        <img\r\n          className=\"profile-image\"\r\n          src={\r\n            previewImage\r\n              ? URL.createObjectURL(previewImage)\r\n              : `${uploads}/users/${user.profileImage}`\r\n          }\r\n          alt={user.name}\r\n        />\r\n      )}\r\n      <form onSubmit={handleSubmit}>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Name\"\r\n          onChange={(e) => setName(e.target.value)}\r\n          value={name || \"\"}\r\n        />\r\n        <input type=\"email\" placeholder=\"E-mail\" disabled value={email || \"\"} />\r\n        <label>\r\n          <span>Profile Picture:</span>\r\n          <input type=\"file\" onChange={handleFile} />\r\n        </label>\r\n        <label>\r\n          <span>Bio:</span>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Profile description\"\r\n            onChange={(e) => setBio(e.target.value)}\r\n            value={bio || \"\"}\r\n          />\r\n        </label>\r\n        <label>\r\n          <span>Want to change your password?</span>\r\n          <input\r\n            type=\"password\"\r\n            placeholder=\"Enter your new password...\"\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            value={password || \"\"}\r\n          />\r\n        </label>\r\n        {!loading && <input type=\"submit\" value=\"Update\" />}\r\n        {loading && <input type=\"submit\" disabled value=\"Loading...\" />}\r\n        {error && <Message msg={error} type=\"error\" />}\r\n        {message && <Message msg={message} type=\"success\" />}\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}